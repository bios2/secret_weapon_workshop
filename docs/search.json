[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Secret weapon workshop",
    "section": "",
    "text": "In many ways, ecology is the discipline of replication. Most ecological studies have multiple species, multiple sites, or multiple time points in their study – almost by definition. As a result, our analyses are almost always designed to include replication. The most common tool that people use is the multi-level model (AKA the hierarchical model). These models are populuare, useful, and very flexible; but they have the weakness of being very complex, difficult to interpret, and often difficult to write correctly.\nAside from the technical complexity, there’s also conceptual complexity when ecological data has many dimensions of space, time, species, etc. It can be quite hard to visualize and understand what’s happening. Also, we may have hypotheses that operate at multiple levels. We may have one hypothesis for what happens within any group, for example, across individuals or species, and another hypothesis for what happens across sites or over time.\nEnter the secret weapon. The secret weapon is the name Andrew Gelmangives to this simple idea. Instead of conducting one large analysis, divide your data into multiple small groups, fit a model to each small group, and compare one or more summary statistics across groups.\nThen we can either analyze the summary statistics in a second study, which is a technique sometimes called “statistics on statistics”, or go on to build a multilevel model. We may even decide that this is a sufficient endpoint for our study.\nThis is a technique that everyone in this room can use right now and which I can confidently recommend as advice to anybody in college who’s beginning a quantitative analysis project.\nThis workshop will be divided into 3 parts. First, we’ll do a worked example using the mite data from the package vegan. In the second, we’re going to split into an exercise section where we will look at different examples from some long-term datasets that I’ve found. And third, we will have time to work on our own datasets."
  },
  {
    "objectID": "index.html#what-is-the-secret-weapon",
    "href": "index.html#what-is-the-secret-weapon",
    "title": "Secret weapon workshop",
    "section": "",
    "text": "In many ways, ecology is the discipline of replication. Most ecological studies have multiple species, multiple sites, or multiple time points in their study – almost by definition. As a result, our analyses are almost always designed to include replication. The most common tool that people use is the multi-level model (AKA the hierarchical model). These models are populuare, useful, and very flexible; but they have the weakness of being very complex, difficult to interpret, and often difficult to write correctly.\nAside from the technical complexity, there’s also conceptual complexity when ecological data has many dimensions of space, time, species, etc. It can be quite hard to visualize and understand what’s happening. Also, we may have hypotheses that operate at multiple levels. We may have one hypothesis for what happens within any group, for example, across individuals or species, and another hypothesis for what happens across sites or over time.\nEnter the secret weapon. The secret weapon is the name Andrew Gelmangives to this simple idea. Instead of conducting one large analysis, divide your data into multiple small groups, fit a model to each small group, and compare one or more summary statistics across groups.\nThen we can either analyze the summary statistics in a second study, which is a technique sometimes called “statistics on statistics”, or go on to build a multilevel model. We may even decide that this is a sufficient endpoint for our study.\nThis is a technique that everyone in this room can use right now and which I can confidently recommend as advice to anybody in college who’s beginning a quantitative analysis project.\nThis workshop will be divided into 3 parts. First, we’ll do a worked example using the mite data from the package vegan. In the second, we’re going to split into an exercise section where we will look at different examples from some long-term datasets that I’ve found. And third, we will have time to work on our own datasets."
  },
  {
    "objectID": "index.html#worked-example",
    "href": "index.html#worked-example",
    "title": "Secret weapon workshop",
    "section": "Worked example",
    "text": "Worked example\n\nData preparation – Center and scale your predictors!\nThis example uses the famous mite dataset, collected by Daniel Borcard in 1989 and included in the famous vegan package.\nSlides introducing the dataset\nFirst, we’ll load the data and do some reorganization and preparation.\n\ndata(mite, package = \"vegan\")\ndata(\"mite.env\", package = \"vegan\")\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(cmdstanr)\n\nThis is cmdstanr version 0.7.1\n- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr\n- CmdStan path: /home/andrew/software/cmdstan\n- CmdStan version: 2.34.1\n\n# combine data and environment\nmite_data_long &lt;- bind_cols(mite.env, mite) |&gt; \n  tibble::rownames_to_column(var = \"site_id\") |&gt; \n  pivot_longer(Brachy:Trimalc2, names_to = \"spp\", values_to = \"abd\")\n\nBecause we’re ecologists, we’ll do one of the most classic ecological models: a Binomial GLM, modelling the presence or absence of a species based on the water content of the soil.\n\\[\n\\begin{align}\n\\text{Presence} &\\sim \\text{Binomial}\\left(\\frac{e^a}{1 + e^a}, 1\\right) \\\\\na &= \\beta_0 + \\beta_xx\n\\end{align}\n\\]\nWhere \\(x\\) is some predictor variable and \\(\\frac{e^a}{1 + e^a}\\) is the logit link function. To keep things simple and univariate, let’s consider only water for \\(x\\).\nFirst, a quick word about centering and scaling a predictor variable:\n\nI center the predictor by subtracting the mean. This changes the intercept of my linear predictor. It becomes the mean log-odds of occurrance when the water content is average\nI divide water content by 100. The dataset has units of grams per Litre of water (see ?vegan::mite.env for more details). This is fine, but I don’t think mites are able to sense differences as precise as a millimeter of water either way. by dividing by 10 I transform this into centilitres, which is more informative.\n\n\nmite_data_long_transformed &lt;- mite_data_long |&gt; \n  mutate(presabs = as.numeric(abd&gt;0),\n         # center predictors\n         water = (WatrCont - mean(WatrCont)) / 100\n         )\n\nThis makes the model:\n\\[\n\\begin{align}\n\\text{Presence} &\\sim \\text{Binomial}\\left(\\frac{e^a}{1 + e^a}, 1\\right) \\\\\na &= \\beta_0 + \\beta_{\\text{water}}\\frac{\\text{water} - \\overline{\\text{water}}}{100}\n\\end{align}\n\\]\n\n\nThe secret weapon: visually\nWe can already get a very good visual expression of the Secret Weapon approach using the power of ggplot2 and stat_smooth()\n\nmite_data_long_transformed |&gt; \n  ggplot(aes(x = water, y = presabs)) + \n  geom_point() + \n  stat_smooth(method = \"glm\", method.args = list(family = \"binomial\")) + \n  facet_wrap(~spp)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nsome things to notice about this figure:\n\nthe x-axis scale has been transformed from “grams per litre” to “centilitres away from average”\nthere is a ton of variation in how different species respond to water!\n\n\n\nThe secret weapon: in tidyverse code\nWe’re going to perform the following steps on these data:\n\ndivide the dataset up into different species\nfit precisely the same model to each one\nextract the coefficients\nvisualize these\n\nTo do this, we’ll be using some handy tricks from the tidyverse, which let us implement a strategy called “split-apply-combine”\n\nSplit-Apply-Combine\n“split-apply-combine” describes a really general workflow in statistics / data science, which was described my Rstudio’s Hadley Wickham in the paper linked above. The idea is to divide data into groups, transform each, and then put the results together. The Secret Weapon is one example of this approach.\nThere are many possible ways to do this in practice. We are using a technique here from the tidyverse, which you can read more about here. A for-loop would also work for this kind of problem!\n\nmite_many_glms &lt;- mite_data_long_transformed |&gt; \n  nest_by(spp) |&gt; \n  mutate(logistic_regressions = list(\n    glm(presabs ~ water,\n        family = \"binomial\",\n        data = data))) |&gt; \n  mutate(coefs = list(broom::tidy(logistic_regressions)))\n\n\nmite_many_glm_coefs &lt;- mite_many_glms |&gt; \n  select(-data, -logistic_regressions) |&gt; \n  unnest(coefs)\n\nmite_many_glm_coefs |&gt; \n  ggplot(aes(x = estimate, y = spp,\n             xmin = estimate - std.error,\n             xmax = estimate + std.error)) + \n  geom_pointrange() + \n  facet_wrap(~term, scales = \"free\")\n\n\n\n\n\n\n\n\nAs you can see, some of these estimates are high, others low. We could also plot these as histograms to see this distribution.\n\nmite_many_glm_coefs |&gt; \n  ggplot(aes(x = estimate)) + \n  geom_histogram(binwidth = .5) + \n  facet_wrap(~term, scales = \"free\")\n\n\n\n\n\n\n\n\nOnce again, the two parameters of this model represent:\n\nIntercept The probability (in log-odds) of a species being present at the average water concentration. some species are common, others are rare.\nwater this is the change in probability (in log-odds) as water increases by one centilitre per litre of substrate.\n\n\n\nFor the Bayesians\nThe above is adapted from a tutorial I wrote for a course in Bayesian statistics. If you would like to see how this is done in the Bayesian software Stan, the course notes are here"
  },
  {
    "objectID": "index.html#practice-examples",
    "href": "index.html#practice-examples",
    "title": "Secret weapon workshop",
    "section": "Practice examples",
    "text": "Practice examples\nHere are some exercises that might make good practice for using the Secret Weapon:\n\nThe mite.env data has another continuous predictor, SubsDens. Adapt the example above for this variable. Which has stronger effects on species presence-absence: water, or substrate density?\nWe used the tidyverse to implement the Secret Weapon. This would also work very well in a for-loop! Write a for-loop version of the same workflow.\nWe did a binomial GLM for presence absence. We could also use a linear model to estimate evenness in each plot, based on a rank-abundance plot, like this:\n\n\nrank_df &lt;- mite_data_long_transformed |&gt; \n  filter(abd != 0) |&gt; \n  group_by(site_id) |&gt; \n  mutate(spp_rank = dense_rank(desc(abd)))\n\nrank_df |&gt; \n  ungroup() |&gt; \n  ## drop some sites just for appearance\n  filter(site_id %in% c(\"1\", \"15\", \"47\")) |&gt; \n  ggplot(aes(x = spp_rank, y = log(abd))) + \n  facet_wrap(~site_id) + \n  geom_point() + \n  stat_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThe slope of these lines is one way to think about evenness – more negative slopes mean a less even community. Use this approach to ask the question: Does evenness change with water concentration?"
  },
  {
    "objectID": "index.html#take-it-to-a-brand-new-dataset-or-to-your-own-science",
    "href": "index.html#take-it-to-a-brand-new-dataset-or-to-your-own-science",
    "title": "Secret weapon workshop",
    "section": "Take it to a brand-new dataset (or to your own science!)",
    "text": "Take it to a brand-new dataset (or to your own science!)\nInstall the LTER data sampler package\n\n# install.packages(\"remotes\")\nremotes::install_github(\"lter/lterdatasampler\")\n\n\nlibrary(lterdatasampler)\n\nCheck out the documentation here\nThere are LOTS of useful datasets in here, which we can use to practice the Secret Weapon. Here are some suggestions to get us started:\n\nSeedling stem length vs Stem dry mass\n\nknitr::kable(head(hbr_maples))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nyear\nwatershed\nelevation\ntransect\nsample\nstem_length\nleaf1area\nleaf2area\nleaf_dry_mass\nstem_dry_mass\ncorrected_leaf_area\n\n\n\n\n2003\nReference\nLow\nR1\n1\n86.9\n13.837\n12.130\n0.0453\n0.0300\n29.104\n\n\n2003\nReference\nLow\nR1\n2\n114.0\n14.572\n15.267\n0.0476\n0.0338\n32.976\n\n\n2003\nReference\nLow\nR1\n3\n83.5\n12.451\n9.731\n0.0423\n0.0248\n25.319\n\n\n2003\nReference\nLow\nR1\n4\n68.1\n9.974\n10.068\n0.0397\n0.0194\n23.179\n\n\n2003\nReference\nLow\nR1\n5\n72.1\n6.838\n5.480\n0.0204\n0.0180\n15.455\n\n\n2003\nReference\nLow\nR1\n6\n77.7\n9.660\n7.643\n0.0317\n0.0246\n20.440\n\n\n\n\n\n\n\nGrowth rates of bison over time\nAlternative idea: average differences between males and females across years.\n\nknitr::kable(head(knz_bison))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndata_code\nrec_year\nrec_month\nrec_day\nanimal_code\nanimal_sex\nanimal_weight\nanimal_yob\n\n\n\n\nCBH01\n1994\n11\n8\n813\nF\n890\n1981\n\n\nCBH01\n1994\n11\n8\n834\nF\n1074\n1983\n\n\nCBH01\n1994\n11\n8\nB-301\nF\n1060\n1983\n\n\nCBH01\n1994\n11\n8\nB-402\nF\n989\n1984\n\n\nCBH01\n1994\n11\n8\nB-403\nF\n1062\n1984\n\n\nCBH01\n1994\n11\n8\nB-502\nF\n978\n1985"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  }
]